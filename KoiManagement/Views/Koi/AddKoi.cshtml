@model IEnumerable<KoiManagement.Models.Variety>

@{
    ViewBag.Title = "Create";
    Layout = "~/Views/Layout/KoiLayout.cshtml";
}

<div class="container" id="add-koi" >
    <form  enctype="multipart/form-data" method="post">
        <h2 id="form-title">THÊM CÁ KOI MỚI</h2>
        @Html.AntiForgeryToken()
        <div class="">
            <div class="row">
                <div class="col-sm-6">
                    <input type="text" class="form-control" placeholder="Tên Cá Koi" id="KoiName" name="KoiName">
                    <label id="lblMessage_koi_name_fail" class="label-error"></label>
                </div>
                <div class="col-sm-6">
                    <select class="form-control" id="VarietyID" name="VarietyID">
                        <option value="0">Chủng Loại</option>
                        @foreach (var item in Model)
                        {
                            <option value="@item.VarietyID">@item.VarietyName</option>
                        }
                    </select>
                    <label id="lblMessage_koi_variety_fail" class="label-error"></label>
                </div>

                </div>
            <div class="row">
                <div class="col-sm-6">
                    <select class="form-control" id="Gender" name="Gender">
                        <option value="N">Giới Tính</option>
                        <option value="M">Đực</option>
                        <option value="F">Cái</option>
                    </select>
                </div>
                <div class="col-sm-6">
                    <input type="text" class="form-control" placeholder="Ngày Sinh" id="DoB" name="DoB" onfocus="(this.type='date')">
                    <label id=" lblmessage_dob_fail" class="label-error"></label>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6">
                    <input type="text" class="form-control" placeholder="Chiều dài" id="Size" name="Size">
                    <label id="lblMessage_koi_size_fail" class="label-error"></label>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <input type="text" class="form-control" placeholder="Tính Cách" id="Temperament" name="Temperament">
                        <label id="lblMessage_temperament_fail" class="label-error"></label>
                    </div>
                </div>
                    <div class="col-sm-6">
                    <input type="text" class="form-control" placeholder="Nguồn Gốc" id="Origin" name="Origin">
                    <label id="lblMessage_origin_fail" class="label-error"></label>
                </div>
            </div>

            <br />
            <div class="row">
                <div class="col-sm-12">
                    <input type="file" accept="image/png, image/jpeg, image/gif" name="file" id="file" class="img" onchange="loadFile(event)" />
                        <br />
                        <div><img id="imagePreview" src="~/Content/Image/Common/blank.jpg" alt="" /></div>
                        <script>
                            var loadFile = function (event) {
                                var output = document.getElementById('imagePreview');
                                imagePreview.src = URL.createObjectURL(event.target.files[0]);
                            };
                        </script>
                </div>
            </div>
            <div class="modal-footer">
                <button type="submit" value="Add" class="btn btn-default">Thêm mới</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">Hủy</button>
            </div>
        </div>
    </form>
</div>


<script type="text/javascript">

        $(document).ready(function () {
            $(function () {
                $("#KoiName").focus();
            });
        });

        $(document).keypress(function (event) {
            var keycode = (event.keyCode ? event.keyCode : event.which);
            if (keycode == "13") {
                if (Validate()) {
                    AddKoi();
                } else {
                    return false;
                }
            }
        });

        $("#btnLogin").click(function () {
            if (Validate()) {
                AddKoi();
            } else {

                return false;
            }
        });
        function Validate() {
            //var username = $("#username").val();
            //var password = $("#password").val();
            //$("#lbl_username_fail").text("");
            //$("#lbl_password_fail").text("");
            //if (username == "") {
            //    $("#lbl_username_fail").text("Vui lòng nhập tên đăng nhập");
            //    $("#username").focus();
            //    return false;
            //} else if (password == "") {
            //    $("#errorMessage").text("");
            //    $("#lbl_password_fail").text("Vui lòng nhập mật khẩu");
            //    $("#password").focus();
            //    return false;
            //}
            return true;
        }

        function AddKoi() {
            var KoiName = $('#KoiName').val();
            var VarietyID = $('#VarietyID').val();
            var Size = $('#Size').val();
            var Gender = $('#Gender').val();
            var DoB = $('#DoB').val();
            var Temperament = $('#Temperament').val();
            var Origin = $('#Origin').val();
            $('#lblMessage_koi_name_fail').text("");
            $('#lblMessage_koi_variety_fail').text("");
            $('#lblMessage_koi_size_fail').text("");
            $('#lblmessage_dob_fail').text("");
            $('#lblMessage_temperament_fail').text("");
            $('#lblMessage_origin_fail').text("");
            $.ajax({
                type: "POST",
                url: "@Url.Action("AddKoi")",
                data: {
                    username: username,
                    password: userpass
                },
                dataType: "Json",
                success: function(res) {
                    switch (res.Status) {
                    case 2:
                        $('#lbl_username_fail').text(res.Message);
                        $('#username').focus();
                        break;
                    case 3:
                        $('#lbl_password_fail').text(res.Message);
                        $('#password').focus();
                        break;
                    case 4:
                        $('#errorMessage').text(res.Message);
                        $('#username').focus();
                        break;
                    case 1:
                        window.location.href = res.RedirectTo;
                        break;
                    }
                }
            });
        }
</script>